<ion-navbar *navbar primary>
  <button menuToggle left>
    <ion-icon name="menu"></ion-icon>
  </button>
  <ion-title>MINOGOI</ion-title>
</ion-navbar>
<ion-header>
  <ion-toolbar>
    <ion-segment [(ngModel)]="tabPage">
      <ion-segment-button value="home">
        <ion-icon name="home"></ion-icon>
      </ion-segment-button>
      <ion-segment-button value="search">
        <ion-icon name="search"></ion-icon>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
  <ion-searchbar *ngIf="tabPage == 'search' && searchedWords.length > 0"
    (ionInput)="search($event)">
  </ion-searchbar>
</ion-header>

<ion-content class="home-page" *ngIf="tabPage == 'home'">
  <ion-card>
    <ion-item>
      {{'Newest_NHK' | translate}}
    </ion-item>
    <button class="btn-load-news" *ngIf="!latestNews && !loadingNews"
      (click)="downloadNews()">
      {{'Download_news' | translate}}
    </button>
    <i class="fa fa-refresh fa-spin fa-3x fa-fw news-loading"
      *ngIf="loadingNews">
    </i>
    <div class="card-news" *ngIf="!loadingNews && !!latestNews">
      <img src="images/bg_newstitle.gif" class="img-news" />
      <div class="title">
        <span [innerHTML]="latestNews.titleWithRuby"></span>
        <div class="date">
          {{latestNews.dateText}}
        </div>
      </div>
    </div>
    <ion-row *ngIf="!loadingNews && !!latestNews">
      <ion-col text-center>
        <button primary clear full small (click)="goToDetail()">
          {{'Detail' | translate}}
        </button>
      </ion-col>
      <ion-col text-center>
        <button primary clear full small (click)="listAllNews()">
          {{'List_all' | translate}}
        </button>
      </ion-col>
    </ion-row>
  </ion-card>
  <ion-card *ngFor="let course of courses; let i = index">
    <div class="card-course">
      <div class="left-side">
        <div class="course-title">{{course.courseName}}</div>
      </div>
      <div class="right-side">
        <div class="number-units">
          {{course.units.length}} {{'Unit' | translate}}
        </div>
        <div class="number-words">
          {{course.noWords}} {{'Word' | translate}}
        </div>
        <div class="number-comments">
          0 {{'Comment' | translate}} <i class="fa fa-comment"></i>
        </div>
        <div class="rating">
          <span>☆</span>
          <span class="focus">☆</span>
          <span>☆</span>
          <span>☆</span>
          <span>☆</span>
        </div>
        <button primary class="btn-start" *ngIf="course.downloaded"
          (click)="goToCourse(course)">
          <ion-icon name="navigate"></ion-icon>
          {{'Start' | translate}}
        </button>
        <button primary class="btn-download" *ngIf="!course.downloaded"
          (click)="downloadCourse(course, i)" [disabled]="course.downloading">
          <ion-icon name="download"></ion-icon>
          {{'Download' | translate}}
        </button>
        <i class="fa fa-spinner fa-spin progress" primary
          *ngIf="!course.downloaded && course.downloading"></i>
        <button danger clear round class="btn-delete"
          *ngIf="course.downloaded" (click)="deleteCourse(course)">
          <i class="fa fa-trash"></i>
        </button>
      </div>
    </div>
  </ion-card>
</ion-content>

<ion-content class="home-page" *ngIf="tabPage == 'search'">
  <h1 class="no-words" *ngIf="searchedWords.length == 0">
    Bạn đang không có từ nào.<br>
    Hãy tải khóa học về để bắt đầu.
  </h1>
  <ion-list [virtualScroll]="searchedWords">
    <ion-item button-primary text-wrap *virtualItem="let word"
      (click)="selectWord($event, word)">
      <ion-label class="word-item">
        <button clear large class="word-bookmark"
          [class.hidden]="!word.bookmarked"
          (click)="addToPlaylist($event, word)">
          <i class="fa fa-bookmark icon-bookmark"></i>
        </button>
        <button clear large class="word-bookmark"
          [class.hidden]="word.bookmarked"
          (click)="addToPlaylist($event, word)">
          <i class="fa fa-bookmark-o icon-bookmark"></i>
        </button>
        <div>
          <h1>{{word.kanji}}</h1>
          <p>{{word.timesPlayed > 0 ? '(' + word.timesPlayed + ') - ' : ''}}
            {{word.timesPlayed > 0 ? (word.lastPlayed | customDate) : ''}}
          </p>
        </div>
      </ion-label>
      <custom-checkbox item-right (onClick)="checkWord($event, word)"
        [checked]="selectedWords.indexOf(word._id) >= 0">
      </custom-checkbox>
    </ion-item>
  </ion-list>
</ion-content>
<audio-setting *ngIf="tabPage == 'search'"></audio-setting>
